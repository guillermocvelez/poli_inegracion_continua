version: "3"

services:
  # HR DB
  hr-db:
    container_name: hr-db
    image: postgres:16.2
    restart: always
    volumes:
      - ./hr-dv/postgres:/var/lib/postgresql/data
    ports:
      - 5435:5432
    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=123456
      - POSTGRES_DB=hrdb

  # HR Frontend
  hr-frontend:
    container_name: hr-frontend
    build: ./Front_recursos_humanos
    ports:
      - 5173:5173
    volumes:
      - ./Front_recursos_humanos:/app
      - /app/node_modules

  # HR Backend
  hr-backend:
    container_name: hr-backend
    build: ./Back_recursos_humanos
    ports:
      - 8000:8000
    depends_on:
      - hr-db
    environment:
      - DATABASE_URL=postgresql://postgres:123456@hr-db:5432/hrdb

  # Jenkins
  jenkins:
    container_name: jenkins
    build: ./jenkins
    privileged: true
    user: root
    ports:
      - 8080:8080
      - 50000:50000
    volumes:
      - ./jenkins_home:/var/jenkins_home
      - /var/run/docker.sock:/var/run/docker.sock
